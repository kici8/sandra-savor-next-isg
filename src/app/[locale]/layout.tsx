import ViewTransitionWrapper from "@/components/ViewTransitionWrapper";
import { routing } from "@/i18n/routing";
import type { Metadata } from "next";
import { hasLocale, NextIntlClientProvider } from "next-intl";
import { setRequestLocale } from "next-intl/server";
import localFont from "next/font/local";
import { notFound } from "next/navigation";
import "../globals.css";
import RootLayoutComponent from "@/components/RootLayoutComponent";

// TODO: add license for the fonts
// Font display
const aujournuit = localFont({
  src: "../../../public/fonts/Aujournuit-Condensed.woff2",
  variable: "--font-aujournuit",
  display: "swap",
});

// TODO: add license for the fonts
// Font main
const ronzino = localFont({
  src: [
    {
      path: "../../../public/fonts/Ronzino-Regular.woff2",
      weight: "400",
      style: "normal",
    },
    {
      path: "../../../public/fonts/Ronzino-Oblique.woff2",
      weight: "400",
      style: "italic",
    },
    {
      path: "../../../public/fonts/Ronzino-Medium.woff2",
      weight: "500",
      style: "normal",
    },
    {
      path: "../../../public/fonts/Ronzino-MediumOblique.woff2",
      weight: "500",
      style: "italic",
    },
    {
      path: "../../../public/fonts/Ronzino-Bold.woff2",
      weight: "700",
      style: "normal",
    },
    {
      path: "../../../public/fonts/Ronzino-BoldOblique.woff2",
      weight: "700",
      style: "italic",
    },
  ],
  variable: "--font-ronzino",
  display: "swap",
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export function generateStaticParams() {
  return routing.locales.map((locale) => ({ locale }));
}

export default async function RootLayout({
  children,
  params,
}: {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}) {
  const { locale } = await params;
  if (!hasLocale(routing.locales, locale)) {
    notFound();
  }
  setRequestLocale(locale);

  return (
    <NextIntlClientProvider>
      <ViewTransitionWrapper>
        <html lang={locale}>
          <body
            className={`${aujournuit.variable} ${ronzino.variable} flex min-h-svh flex-col bg-gradient-to-t from-yellow-100 to-lime-800 font-ronzino text-blue-900 dark:bg-black dark:text-orange-50`}
          >
            <RootLayoutComponent>{children}</RootLayoutComponent>
          </body>
        </html>
      </ViewTransitionWrapper>
    </NextIntlClientProvider>
  );
}
